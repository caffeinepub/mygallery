{
  "kind": "implementation_plan",
  "version": "1.0",
  "title": "Folders: reliable create + swipe-only row actions",
  "requirements": [
    {
      "id": "REQ-5",
      "summary": "Make folder creation succeed consistently and ensure the newly created folder appears in the folders list immediately without requiring reload/navigation/refresh.",
      "acceptanceCriteria": [
        "When the folders list is empty, creating a folder succeeds and the new folder appears in the list immediately.",
        "When the folders list already contains folders, creating an additional folder succeeds and the new folder appears in the list immediately.",
        "Folder creation does not rely on the folder list query being previously populated (i.e., it works even on first-time use).",
        "If folder creation fails (backend error / actor not ready), the UI shows an error and does not add a phantom folder entry to the list."
      ],
      "file_operations": [
        {
          "path": "frontend/src/hooks/useQueries.ts",
          "operation": "modify",
          "description": "Harden the folder creation mutation so that after a successful create it triggers an immediate folders list refresh even when the folders query is not currently active (e.g., first-time use / dialog just opened). Ensure error paths do not update the folders cache, and keep actor-not-ready failures surfaced cleanly."
        },
        {
          "path": "frontend/src/components/FoldersDialog.tsx",
          "operation": "modify",
          "description": "Update the create-folder submit flow to rely on the improved mutation refresh behavior so the list updates immediately in the dialog (including when starting from zero folders). Ensure failures show an error and do not display a newly created folder row unless the backend create succeeded."
        }
      ]
    },
    {
      "id": "REQ-6",
      "summary": "Hide rename/delete actions by default and reveal them only via swipe/reveal interaction, with one row open at a time and outside-click/tap to close.",
      "acceptanceCriteria": [
        "In the folders list, rename and delete actions are hidden by default for each folder row.",
        "Swiping left on a folder row reveals the rename and delete actions for that row.",
        "Only one folder rowâ€™s swipe actions can be open at a time; opening one closes any previously open row.",
        "Tapping/clicking outside an open swipe row closes it.",
        "The swipe behavior works on touch devices; if pointer input is supported (mouse/trackpad), the same reveal interaction remains usable without showing actions by default."
      ],
      "file_operations": [
        {
          "path": "frontend/src/components/FoldersDialog.tsx",
          "operation": "modify",
          "description": "Remove the always-visible rename/delete icon buttons from the default folder row rendering and consistently use the swipe/reveal row interaction for actions. Keep the existing single-open-row state (openSwipeRowId) so opening one row closes any previously open row."
        },
        {
          "path": "frontend/src/components/SwipeActionsRow.tsx",
          "operation": "modify",
          "description": "Extend the swipe-to-reveal behavior so it remains usable with pointer input (mouse/trackpad) without showing actions by default (e.g., pointer-driven drag/reveal). Preserve outside click/tap to close, and ensure the actions remain visually hidden until the row is revealed."
        }
      ]
    }
  ]
}